---
title: "Blog Setup - Webserver & Hugo"
date: 2017-09-07T15:21:43+02:00
---

I know that my [About Me](/about/) page says that this blog will mostly be
about IT security, but I also said that it may contain other things that come
to my mind or that I simply find interesting. To tell the truth, my current
problem is that I have a blog but nothing extremely urgent to write on it;
however, I want at least something to be in it before putting it online. As a
consequence, it seemed just fair to give a small description of how I set up
this website so that I can verify that everything is displayed as expected and
I can also improve my limited and rusty Markdown skills.

As a side note, I have no intention of writing a full tutorial on how to flash
a Raspbian image on an SD card, the [official documentation][raspbian_install]
already provides a pretty good one. I will just say that I installed [Raspbian
Stretch Lite][raspbian] since I do not have any need for a desktop environment
on a headless server. In addition, all the setup related to my private network
setup is omitted, this post assumes that the Raspberry Pi correctly exposes
port 80 to the Internet; if you need a reference to complete this task,
[this][network_setup] is a good one.

[raspbian_install]: https://www.raspberrypi.org/documentation/installation/installing-images/linux.md
[raspbian]: https://www.raspberrypi.org/downloads/raspbian/
[network_setup]: http://www.penguintutor.com/linux/light-webserver

## DDNS Service

As you can tell from the fact that I am hosting this website on a Pi3, I am also
using my home ADSL connection to do so. Apart from the obvious bandwidth
problems, this imposes some constraints on the solutions I could adopt to create
this blog.

First of all, I do not have a static public IP but a dynamically assigned one.
I solved this problem a long time ago using a DDNS service: the one I am
currently using is [FreeDNS][freedns], which has a large catalog of domain
names, shared by its users, for which you can create a subdomain free of
charge. After this, the IP address can be updated simply setting up a `cron`
job that makes an HTTP request to the DDNS service at regular time intervals.
This `cron` job can be even autogenerated by the DDNS service; mine looks
something like this:

	4,9,14,19,24,29,34,39,44,49,54,59 * * * * sleep 24 ; \
	curl -s http://sync.afraid.org/u/<random-auth-token>/ \
	>> /tmp/freedns_egeretto_h4ck_me.log 2>/dev/null

[freedns]: https://freedns.afraid.org/

## Webserver

Once solved the domain name issue, the following problem was choosing a
webserver that both suited my needs and was lightweight enough to give good
response times even on my Pi3. On my last setup I used [Apache][apache] but I
wanted to transition to a webserver that is both lighter and has a smaller
memory footprint. As a consequence, I stumbled on [lighttpd][lighttpd] which,
apparently, gets used quite often in configurations similar to mine. Moreover,
there is also the possibility of adding PHP support, which I was interested in,
even if it does not come by default.

As for the install procedure, it is sufficient to install the `lighttpd` package
and the installation scripts will also enable the `systemd` unit for the
webserver. The content displayed is the one in `/var/www/html`, which contains
only a test page after the installation. I also adjusted the permissions for
that directory so that my user could modify its content without having to be
`root`, which is convenient for the deployment script I intend to use.

[apache]: https://www.apache.org/
[lighttpd]: https://www.lighttpd.net/

## Website generator

Since the webserver was up and running, I shifted my attention on the actual
content to be displayed. Given my really low-powered configuration, I decided to
create a static website, so that my poor Pi3 would not bear the burden of a
whole Wordpress website that I also really did not need.

Some time ago, I watched a video by [Bryan Lunduke][lunduke], a youtuber that
mostly focuses on Linux-related topics, where he was talking about how
[Hugo][hugo] was one of the best static website generators that were ever
written.  Given these premises, I decided to give it a try and see if I could
easily produce the result I wanted to obtain. As a matter of fact, I just
followed the [quickstart guide][hugo_quickstart], picked a theme from those
available on the website and then started writing the content you are reading
now.

One of the most convenient things made available by this tool is the live
preview that can be obtained simply by running:

	$ hugo server -D

This will start a local webserver that also updates the content while it is
being modified so that the result of the changes can be observed directly in
your browser. After completing the development, a full build of the website can
be obtained in the `public/` folder of the project simply by running:

	$ hugo

I found this work flow all really convenient since it suited my need of a blog
that was both easy to develop and simple to manage.

[lunduke]: http://lunduke.com/
[hugo]: https://gohugo.io/getting-started/quick-start/
[hugo_quickstart]: https://gohugo.io/getting-started/quick-start/

## Theme

As for the theme I chose, I was looking for something minimal and, after various
attempts, I settled with [Pickles][pickles]. I have to say that I really like the
minimalist style and also the ease of configuration. Indeed, it is possible to
add various elements, like links to social networks and analytics, without any
effort, just by changing some parameters in the `config.toml` in the project
root.

The only tweak I made, for now, is that I added the possibility of inserting
HTML tags in the blog title. Indeed, such a long title was not wrapping
correctly on mobile and thus I had to put a `<wbr>` tag in it. The problem was
that the tag was being escaped by the Go code and thus I had to change the theme
so that the `title` field was marked as `safeHTML` and Hugo would let it go
through.

[pickles]: https://themes.gohugo.io/hugo_theme_pickles/
